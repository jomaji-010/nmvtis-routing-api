<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<error-handler name="global-commonError_Handler" doc:id="aca7bd11-795c-4df4-82ce-c3d99b6a84bd" >
	
<on-error-propagate enableNotifications="true" logException="true" doc:name="Dataweave Catch Exception Strategy" doc:id="371747d6-c9ee-4d48-bc00-34db8d789400" type="MULE:EXPRESSION">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="696727c5-989b-4741-b4db-61cc366ef69a" message='Id: #[correlationId], dataWeave: errorMessage: #[error.description] '/>
            <set-variable value="${errors.error-code-500}" doc:name="set-error-code" doc:id="d8973a92-e0c1-431f-b6a9-f3892d602e58" variableName="errorCode" />
			<set-variable value='#["expression error"]' doc:name="set-error-description" doc:id="b1cdd92e-3fc7-43f7-9c96-0cca4484e3b4" variableName="errorDescription"/>
			<set-variable value="500" doc:name="set httpStatus" doc:id="c7ec0ef6-19b5-4057-a9a1-168f0e68d6c5" variableName="httpStatus"/>
			<flow-ref doc:name="global-common-transform" doc:id="1b7ba27e-0a79-46e2-b020-af5fee478f71" name="global-common-transform"/>
			<flow-ref doc:name="global-common-error-exit" doc:id="1f5d5aaa-53ee-4a3a-bbdf-8f4338e43708" name="global-common-error-exit"/>
</on-error-propagate>

<on-error-propagate enableNotifications="true" logException="true" doc:name="Source Send Exception Strategy" doc:id="b973041b-c603-4df0-a434-32beda14f34f" type="MULE:SOURCE_RESPONSE_SEND">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="bbafd8ed-568f-4808-9842-9a154875d022" message='Id: #[correlationId], source system: errorMessage: #[error.description] '/>
            <set-variable value="${errors.error-code-408}" doc:name="set-error-code" doc:id="c1acbbb9-f73d-439b-82a4-a837cd3890f0" variableName="errorCode" />
			<set-variable value='#["source system is not responding"]' doc:name="set-error-description" doc:id="af266308-9739-4093-8ef6-1e71197ee5ca" variableName="errorDescription"/>
			<set-variable value="408" doc:name="set httpStatus" doc:id="debaffd2-8c00-46d1-8b82-0d1cd6cdeb95" variableName="httpStatus"/>
			<flow-ref doc:name="global-common-transform" doc:id="81a046ec-ef49-470c-892c-769cd25be608" name="global-common-transform"/>
			<flow-ref doc:name="global-common-error-exit" doc:id="a3f4fa9c-7f0f-412d-a07f-ca023ea976c7" name="global-common-error-exit"/>
</on-error-propagate>

      <on-error-propagate enableNotifications="true" logException="true" doc:name="Dataweave Catch Exception Strategy" doc:id="69a19473-617d-4c4e-9fc2-0f104412f488" type="EXPRESSION">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="ee2feda7-c284-4519-89d4-69993353ed3e" message='Id: #[correlationId], dataWeave: errorMessage: #[error.description] '/>
            <set-variable value="${errors.error-code-400}" doc:name="set-error-code" doc:id="32a3f0af-76da-4ce2-ad1a-91bf7987031f" variableName="errorCode" />
			<set-variable value='#["transform exception"]' doc:name="set-error-description" doc:id="180550c2-36fa-41a8-9a83-1b10910bc418" variableName="errorDescription"/>
			<set-variable value="#[error.errorMessage.attributes.statusCode]" doc:name="set httpStatus" doc:id="21329e6f-7086-46b9-ba8a-45a023f711d1" variableName="httpStatus"/>
			<flow-ref doc:name="global-common-transform" doc:id="a10dd30f-0f55-4c92-9598-4cb7b74ef45f" name="global-common-transform"/>
			<flow-ref doc:name="global-common-error-exit" doc:id="3987d4ce-8800-4f23-bd5d-7c5a88f689ec" name="global-common-error-exit"/>
      
</on-error-propagate>   

       <on-error-propagate enableNotifications="true" logException="true" doc:name="Connection Error Handler" doc:id="8a081460-7401-479a-a421-f7fce4855fe8" when='#[error.cause.class contains "java.util.concurrent.TimeoutException"]'>
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="02f515a2-369d-4118-8e90-645d89b56210" message="Id: #[correlationId], connectivity: errorMessage: #[error.description] ;java,utill"/>
			<set-variable value="${errors.error-code-408}" doc:name="set-error-code" doc:id="b3ac9062-e379-4da2-bc16-396cfd470ad2" variableName="errorCode" />
			<set-variable value='#["java utill timeout exception"]' doc:name="set-error-description" doc:id="bf77da84-95aa-4e3a-803c-2f7f0b848386" variableName="errorDescription"/>
			<set-variable value='#["508"]' doc:name="set httpStatus" doc:id="4977288b-adbc-4084-b8ab-23f815df9aad" variableName="httpStatus"/>
			
			<flow-ref doc:name="global-common-transform" doc:id="ad4c4fac-308d-4f01-8631-fb579c3bf39b" name="global-common-transform"/>
      		<flow-ref doc:name="global-common-error-exit" doc:id="abb95ede-00b8-40e3-8680-bdf8602d8f88" name="global-common-error-exit"/>
		</on-error-propagate>  

    <on-error-propagate enableNotifications="true" logException="true" doc:name="Connection Error Handler" doc:id="fe8b4a40-2a19-4886-94ac-46d3cc160310" when='#[error.cause.class contains "org.mule.runtime.core.privileged.routing.CompositeRoutingException"]'>
         <logger level="ERROR" doc:name="log-correlation-id-composite" doc:id="a5a02289-416c-4583-980b-d8a7b220cebe" message="Id: #[correlationId], connectivity: errorMessage: #[error.description] ; routing exception "/>
			<set-variable value="${errors.error-code-408}" doc:name="set-error-code-composite" doc:id="739cb531-3199-4bcb-9743-8a24ab88509a" variableName="errorCode" />
			<set-variable value='#["routing exception"]' doc:name="set-error-description-composite" doc:id="146edd18-77b2-4243-900f-ae816a916137" variableName="errorDescription"/>
			<set-variable value='#["408"]' doc:name="set httpStatus-composite" doc:id="6dc8c2ce-fb6b-42f4-a40d-900f8d033da8" variableName="httpStatus"/>
			
			<flow-ref doc:name="global-common-transform" doc:id="19d198e5-f46e-47fe-8fa0-4337d42ce1dc" name="global-common-transform"/>
      		<flow-ref doc:name="global-common-error-exit" doc:id="d56a0643-b44a-4ea1-8558-4f85d11a460e" name="global-common-error-exit"/>
</on-error-propagate> 

	<on-error-propagate enableNotifications="true" logException="true" doc:name="Connection Error Handler" doc:id="bbeb5ae2-69cd-40fb-9dd9-e8a10d92ca27" when='#[error.cause.class contains "org.mule.extension.http.api.error.HttpRequestFailedException"]'>
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="29e9cd9c-a748-4b4f-b316-1af1357ca68d" message="Id: #[correlationId], http-request: errorMessage: #[error.description] ;"/>
			<set-variable value="${errors.error-code-408}" doc:name="set-error-code" doc:id="3baa5bc5-587f-44b7-8c97-d52f364a621c" variableName="errorCode" />
			<set-variable value='#[error.description]' doc:name="set-error-description" doc:id="9c2816d4-fe73-4f03-a2c4-b08e07ba4aa2" variableName="errorDescription"/>
			<set-variable doc:name="set httpStatus" doc:id="0af887a5-42db-40f2-b679-b251f90d64d5" variableName="httpStatus" value="408"/>
			
			<flow-ref doc:name="global-common-transform" doc:id="0d44f81a-3cc1-4132-accc-8c25441c92ed" name="global-common-transform"/>
      		<flow-ref doc:name="global-common-error-exit" doc:id="966d6f68-5bf9-492e-a828-61d6ff8826b9" name="global-common-error-exit"/>
</on-error-propagate>
   
     
      <!-- everything else will pass to the apiChoiceExceptionStrategy -->
      <!-- start of typical REST exceptions -->
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:METHOD_NOT_ALLOWED" doc:id="8061c3cb-7170-479a-84cc-4e814befb119" type="APIKIT:METHOD_NOT_ALLOWED">
         <logger level="ERROR" doc:name="log-correlation-id-method-not-allowed" doc:id="ffec557b-745b-4b47-8302-620c69eaee99" message="ID: #[correlationId]; method not allowed;errorMessage: #[error.description]"/>
                             <set-variable value="${errors.error-code-405}" doc:name="set-error-code" doc:id="4aeea566-c32f-4a0f-b2b5-ce7a2458a996" variableName="errorCode" />
			<set-variable value='#["Method Not Allowed"]' doc:name="set-error-description" doc:id="15d0e186-bcca-4d56-ad0e-ed850aec380d" variableName="errorDescription"/>
			<set-variable value="405" doc:name="set httpStatus" doc:id="29dd2d09-d2f4-47b5-b516-7b569d7f132e" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="2a3a77c1-6138-4e8c-97a3-cdadbdfc9a8b" name="global-common-transform" />
			<flow-ref doc:name="global-common-error-exit" doc:id="bf98e51c-fd8e-4973-b233-b48a508907db" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:NOT_ACCEPTABLE" doc:id="1c49a401-5d22-46ef-9f71-a000ed9096a1" type="APIKIT:NOT_ACCEPTABLE" >
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="23177079-3740-4b89-a302-d61e93aa9e71" message="ID: #[correlationId]; not acceptable. errorMessage: #[error.description]"/>
          <set-variable value="${errors.error-code-406}" doc:name="set-error-code" doc:id="95657719-9fa5-4fa6-9e14-49554d69bcd3" variableName="errorCode" />
  <set-variable value='#["Not Acceptable"]' doc:name="set-error-description" doc:id="115dcf96-b9a2-48bd-95a7-779267cb4a37" variableName="errorDescription"/>
  <set-variable value="406" doc:name="set httpStatus" doc:id="3f25f7a3-4762-4db3-bfe0-4b48ad45aaa1" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="bc0757ea-524f-4ab7-b3a5-fe2c2c28bb37" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="d985fcde-c86c-4ae4-bc91-521f0f382094" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:UNSUPPORTED_MEDIA_TYPE" doc:id="2609b07f-aa10-4be8-b299-8ab7e38c2e34" type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="13a33e5a-4168-4c86-9f16-04ef5e5484dc" message="ID: #[correlationId]; unsupported media type;errorMessage: #[error.description]"/>
          <set-variable value="${errors.error-code-415}" doc:name="set-error-code" doc:id="5c853620-f277-4b83-94e3-90424449a2f5" variableName="errorCode" />
			<set-variable value='#["unsupported media type"]' doc:name="set-error-description" doc:id="c65bb79c-1822-460e-bb56-55a1ea9c4930" variableName="errorDescription"/>
			<set-variable value="415" doc:name="set httpStatus" doc:id="a18b879c-14f5-4ebb-bc10-64a344f15f7b" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="ee667e29-3ff6-4043-92e2-1577733bc30f" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="1ef3e3e5-317d-4196-83c7-14966da0a70c" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:BAD_REQUEST" doc:id="9b311e03-17cf-45e7-ab73-4defbaa538a3" type="APIKIT:BAD_REQUEST" >
			<logger level="ERROR" doc:name="log-correlation-id" doc:id="8268be27-82ad-40a8-b761-a9f753cdc067" message="Id: #[correlationId], bad request: errorMessage: #[error.description]; message: #[error.errorMessage]"/>
             <set-variable value="${errors.error-code-400}" doc:name="set-error-code" doc:id="f38d8803-c333-4fd3-bc10-b27df4c7350c" variableName="errorCode" />
			<set-variable value='#[error.description]' doc:name="set-error-description" doc:id="dd37703b-de42-4d7b-a3cf-3b234cf0d11f" variableName="errorDescription"/>
			<set-variable value="400" doc:name="set httpStatus" doc:id="aa1460b4-bd5e-443a-ad75-213e31facd87" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="37edbb09-0662-4688-a834-88390101d58c" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="007f7e08-3638-4b96-a7d4-e0bbe004970f" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:NOT_FOUND" doc:id="491933a2-b995-4ccd-afb9-be68cc88eee0" type="APIKIT:NOT_FOUND">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="70a8ff29-726b-4aeb-beb8-b31a130c0b7e" message="Id: #[correlationId], notFound: errorMessage: #[error.description]"/>
               
               <set-variable value="${errors.error-code-404}" doc:name="set-error-code" doc:id="f2d9be66-80e7-495a-a607-33f345483a13" variableName="errorCode" />
  <set-variable value='#["Not Found"]' doc:name="set-error-description" doc:id="be283046-36f1-4806-9399-0b58d7eb9c59" variableName="errorDescription"/>
  <set-variable value="404" doc:name="set httpStatus" doc:id="a88dc642-6b8d-4bba-95b7-7a7cdffc45ab" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="bb24ba4a-3577-460e-8494-10ba3c600fda" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="665c555b-d422-420e-8e4e-f73c621d8ec1" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:NOT_IMPLEMENTED" doc:id="11f4b6f1-bab9-48dd-9d74-2e8f677cfaae" type="APIKIT:NOT_IMPLEMENTED">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="964af670-307d-4881-8560-8afca4429d7c" message="ID: #[correlationId]; not implemented; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-501}" doc:name="set-error-code" doc:id="958006f1-3931-45bc-b76c-48d3a0b71f74" variableName="errorCode" />
  <set-variable value='#["Not Implemented"]' doc:name="set-error-description" doc:id="a6e66931-e64b-4603-954f-d9cfabc96876" variableName="errorDescription"/>
  <set-variable value="501" doc:name="set httpStatus" doc:id="5ba30f4b-a408-4a44-b876-267deecf2172" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="481ebc3b-2eb6-4fcb-a926-83fd03d4bcb1" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="6f5bbae1-cc2d-4408-94c9-99438e331cef" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="APIKIT:ILLEGAL_ARGUMENT_EXCEPTION" doc:id="9ab27689-d3ba-4c53-846d-09dd882ad828" when="#[error.cause.class contains &quot;java.lang.IllegalArgumentException&quot;]">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="bc38e8b6-c183-4afc-bae6-3a6399c303ee" message="ID: #[correlationId]; Global Error Handler Flow5."/>
         <set-variable value="${errors.error-code-500}" doc:name="set-error-code" doc:id="df273233-1984-4976-b8f8-37ebf3e77521" variableName="error-code" />
         <flow-ref doc:name="global-common-transform" doc:id="11844852-fd84-43f3-b36a-c6b7aae3db65" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="4e9bc435-6740-46af-af40-c12f8c38bd3f" name="global-common-error-exit"/>
      </on-error-propagate>
      <!-- end of typical REST exceptions -->
   

<on-error-propagate enableNotifications="true" logException="true" doc:name="Dataweave Catch Exception Strategy" doc:id="4dd01e09-e21b-40dd-9747-42699934aa4c" type="STREAM_MAXIMUM_SIZE_EXCEEDED">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="a169ff2f-2150-4aed-8933-4f7304aa82de" message='Id: #[correlationId], errorMessage: #[error.description] '/>
            <set-variable value="${errors.error-code-stream-exceeded-500}" doc:name="set-error-code" doc:id="19952da3-529a-4e0d-8889-c2d1b6e85f18" variableName="errorCode" />
			<set-variable value='#["Maximum Stream Exceeded"]' doc:name="set-error-description" doc:id="c3768d73-df3b-4c67-aacd-d1cee3180429" variableName="errorDescription"/>
			<set-variable value="500" doc:name="set httpStatus" doc:id="31869067-bc74-40b6-abd6-840acdf51291" variableName="httpStatus"/>
			<flow-ref doc:name="global-common-transform" doc:id="343f9b44-fde1-474b-8120-8b8b915d6373" name="global-common-transform"/>
			<flow-ref doc:name="global-common-error-exit" doc:id="bfd9602f-6d60-4611-a4e6-d4016d93c66f" name="global-common-error-exit"/>
</on-error-propagate>
      <!-- no data to transform, typically nothing in response -->
     <on-error-propagate enableNotifications="true" logException="true" doc:name="HTTP:CONNECTIVITY" doc:id="bd996818-f689-4862-a66d-37709abb0f3d" type="HTTP:CONNECTIVITY">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="42312834-de2a-4d9e-9af1-a8095090730b" message="ID: #[correlationId]; http connectivity error; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-502}" doc:name="set-error-code" doc:id="8b5fa830-800b-484d-9cfa-3f4803c0db86" variableName="errorCode" />
  <set-variable value='#["HTTP Connectivity"]' doc:name="set-error-description" doc:id="8049ea20-08e9-4bec-9f99-058cfcf1b5fd" variableName="errorDescription"/>
  <set-variable value="502" doc:name="set httpStatus" doc:id="ace77657-5be7-4175-b44a-ecb8ae215ba5" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="61ad5b3f-ff33-4e3a-b55d-b8af8cab2ee7" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="ed98eec6-078f-43fc-92c3-b1bc7dca3895" name="global-common-error-exit"/>
      </on-error-propagate>
     <on-error-propagate enableNotifications="true" logException="true" doc:name="HTTP:TIMEOUT" doc:id="0f35f0d7-75e5-4717-b651-a0bd460208a0" type="HTTP:TIMEOUT">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="d5bd1a5c-3e8d-466c-91d0-84393aaf8655" message="ID: #[correlationId]; http timeout error; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-408}" doc:name="set-error-code" doc:id="a8b426a7-6be8-4d6e-ada2-77af77acf37b" variableName="errorCode" />
  <set-variable value='#["HTTP Timeout"]' doc:name="set-error-description" doc:id="a79e9a25-b4b6-48cd-8c69-1b8ec43b66ba" variableName="errorDescription"/>
  <set-variable value="408" doc:name="set httpStatus" doc:id="93f54079-3283-478c-9bf1-3c65947d691b" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="0ca6df42-9116-42f3-af05-aad623da1d5f" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="5880ed9d-0194-4567-adc1-c336bf0bcb4c" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="HTTP:UNAUTHORIZED" doc:id="4f54cbeb-aa84-4e30-9939-387b1beaede3" type="HTTP:UNAUTHORIZED">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="8b5bfcc8-f81d-4a5a-8dd2-31cc99b43158" message="ID: #[correlationId]; http unauthorized error; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-401}" doc:name="set-error-code" doc:id="1962a42e-48e1-48c0-b359-f6b6c5fa9432" variableName="errorCode" />
  <set-variable value='#["HTTP Unauthorzed"]' doc:name="set-error-description" doc:id="88e41e03-516a-4200-a913-458b6ec171b9" variableName="errorDescription"/>
  <set-variable value="401" doc:name="set httpStatus" doc:id="6b6b421e-017f-4ba0-9ea8-1d9a9f55d709" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="6ec53a6d-21a3-47d9-a59d-502a1d351f47" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="9483ffa4-cd4e-40c6-b22d-0d8bdc176185" name="global-common-error-exit"/>
      </on-error-propagate>
       <on-error-propagate enableNotifications="true" logException="true" doc:name="HTTP:TOO_MANY_REQUESTS" doc:id="74010f2c-7359-4470-b0fd-4e664a31e844" type="HTTP:TOO_MANY_REQUESTS">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="1fa44565-7e6c-4f53-8478-ce9c0e6033f2" message="ID: #[correlationId]; http too many request; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-429}" doc:name="set-error-code" doc:id="e89322ce-0c3a-41ad-8d4e-9eb235dfb6e3" variableName="errorCode" />
  <set-variable value='#["HTTP Too Many Requests"]' doc:name="set-error-description" doc:id="0700f1fc-1c54-4505-ade9-a1dc429a26e2" variableName="errorDescription"/>
  <set-variable value="429" doc:name="set httpStatus" doc:id="f8df3ee5-c58c-4a61-8a05-ca383a2b88ec" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="f704bc6a-26d4-4751-a543-a1c716f44c88" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="dfbb75dd-f62a-4565-8444-85dae7b73740" name="global-common-error-exit"/>
      </on-error-propagate>
     
     <on-error-propagate enableNotifications="true" logException="true" doc:name="HTTP:SERVICE_UNAVAILABLE" doc:id="312eef28-d739-4bf4-b4a0-03e274faf90d" type="HTTP:SERVICE_UNAVAILABLE">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="d0305755-3987-4c04-8319-00d77d02c46a" message="ID: #[correlationId]; http too many request; errorMessage: #[error.description]"/>
            <set-variable value="${errors.error-code-503}" doc:name="set-error-code" doc:id="adbbfe6c-73a3-44e4-aa62-fb44526e5637" variableName="errorCode" />
  <set-variable value='#["HTTP service unavailable"]' doc:name="set-error-description" doc:id="01467697-29f8-4c87-b81e-0dec3b358b08" variableName="errorDescription"/>
  <set-variable value="503" doc:name="set httpStatus" doc:id="3db591f3-9ac7-4de6-90c6-d62303243121" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="94535972-2a76-442f-849c-b2515c0461b8" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="beba3098-695f-4fb1-9217-15af89425146" name="global-common-error-exit"/>
      </on-error-propagate>
      
     <on-error-propagate enableNotifications="true" logException="true" doc:name="INVALID_TRANSFORMATION" doc:id="06a65956-4f14-425a-8aaa-8bae0e01f82f" when="#[error.cause.class contains &quot;org.mule.runtime.core.api.expression.ExpressionRuntimeException&quot;]">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="12f8a61c-552c-4f73-b827-cc2add27f660" message="ID: #[correlationId]; Global Error Handler Flow6."/>
                             <set-variable value="${errors.error-code-500}" doc:name="set-error-code" doc:id="693ea49b-1c38-4dc9-9d4c-7f9f1a6e10c7" variableName="error-code" />
        <!--   <set-variable value="${application-msgs.common-error}" doc:name="set-common-error" doc:id="933f07ec-a492-496b-a694-92d0d7e2d821" variableName="common-error" /> -->
         <flow-ref doc:name="global-common-transform" doc:id="466bdc33-a099-435d-9538-3321fd96e492" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="510130df-f867-4f0b-bc6e-c692187edad2" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="JAVA_LANG_NULLPOINTER" doc:id="1a3e9f25-3382-4a9d-8292-f1f5b0632bc3" when="#[error.cause.class contains &quot;java.lang.NullPointerException&quot;]">
         <logger level="ERROR" doc:name="log-correlation-id" doc:id="1e62bd99-b38e-4e9b-b629-9110693259cd" message="ID: #[correlationId]; Global Error Handler Flow7."/>
                             <set-variable value="${errors.error-code-500}" doc:name="set-error-code" doc:id="43abd941-3e90-43ce-b642-89d1f6fda122" variableName="error-code" />
         <flow-ref doc:name="global-common-transform" doc:id="79aa7deb-e6ac-44f9-8c06-9e992c00d6ca" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="34d10892-b19b-49cd-84ad-ae5264e7993a" name="global-common-error-exit"/>
      </on-error-propagate>
      <!-- All SFTP exceptions -->
      <!-- custom exceptions  -->
      <!--All Other Exception -->
      <!-- <on-error-propagate enableNotifications="true" logException="true" doc:name="generalError" doc:id="31278b2f-88fa-4797-9530-e98166e95b71" when='#[payload.errorMessage != "" and payload.errorMessage != null]'>
			<set-variable value="#[error.errorMessage.attributes.statusCode]" doc:name="set httpStatus" doc:id="e5622699-9c82-4d4d-be5b-97f6b4f08a8d" variableName="httpStatus"/>
			<ee:transform doc:name="Transform Message" doc:id="4a295863-ca52-401c-9d36-474642ad368e" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
-&#45;&#45;
payload]]></ee:set-payload>
				</ee:message>
			</ee:transform>
      </on-error-propagate> -->
     
      <on-error-propagate enableNotifications="true" logException="true" doc:name="ALL_OTHER" doc:id="8e6b3f46-64e9-487f-ab86-40acd573c2de" type="ANY">
         <logger level="ERROR" doc:name="log-correlation-id-any" doc:id="b330c2e6-6ce0-4768-b98d-eb58f36c41dc" message="ID: #[correlationId]; internal server error; errorMessage: #[error.description]; reasonPhrase = #[error.errorMessage.attributes.reasonPhrase]"/>
            <set-variable value="${errors.error-code-500}" doc:name="set-error-code-any" doc:id="6a7c7f22-d7b5-41b7-be4e-ca6bc11d7865" variableName="errorCode" />
  <set-variable value='#[if(error.reasonPhrase == null) "Internal Server Error" else error.reasonPhrase]' doc:name="set-error-description-any" doc:id="ba862fb7-7353-4f30-95bf-f382281eb031" variableName="errorDescription"/>
  <set-variable value="#[error.errorMessage.attributes.statusCode]" doc:name="set httpStatus-any" doc:id="5105c815-9487-4bdf-878f-b0e2809edcbe" variableName="httpStatus"/>
         <flow-ref doc:name="global-common-transform" doc:id="627c1225-4521-403c-9c16-b5faf520dd4c" name="global-common-transform" />
         <flow-ref doc:name="global-common-error-exit" doc:id="51439164-97ec-429e-a322-c3522ba3e6df" name="global-common-error-exit"/>
      </on-error-propagate>
      <on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="7fba4f21-2116-41f8-b51f-82077be28e7c" type="SALESFORCE:LIMIT_EXCEEDED,SALESFORCE:CONNECTIVITY,SALESFORCE:INVALID_RESPONSE,SALESFORCE:RETRY_EXHAUSTED,SALESFORCE:TIMEOUT,SALESFORCE:MUTUAL_AUTHENTICATION_FAILED,SALESFORCE:NOT_FOUND,SALESFORCE:INVALID_INPUT">
            <choice doc:name="Choice" doc:id="46b6d4e7-6e16-44d9-83b0-8ce6a17caed8" >
                <when expression='#[error.errorType.asString=="SALESFORCE:LIMIT_EXCEEDED"]'>
                    <ee:transform doc:name="Transform Message" doc:id="2b06a527-4237-4058-891b-be8f98a8112b" >
                        <ee:message >
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:CONNECTIVITY"]'>
                    <ee:transform doc:name="Transform Message" doc:id="036cfc4a-7d57-4d10-8e24-9c2afb70dd3c">
                        <ee:message>
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:INVALID_RESPONSE"]'>
                    <ee:transform doc:name="Transform Message" doc:id="9bc74e84-061d-4db5-bc39-9df5e2f01155" >
                        <ee:message >
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:RETRY_EXHAUSTED"]'>
                    <ee:transform doc:name="Transform Message" doc:id="31d0be83-ab09-424c-9499-07c92cf55e4d">
                        <ee:message>
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 503]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:TIMEOUT"]'>
                    <ee:transform doc:name="Transform Message" doc:id="7adffaca-8352-4805-85b7-589da8676298">
                        <ee:message>
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 408]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:MUTUAL_AUTHENTICATION_FAILED"]'>
                    <ee:transform doc:name="Transform Message" doc:id="0ed41c92-c873-4e2c-9b2e-d241e96d3ea2" >
                        <ee:message >
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:INVALID_INPUT"]'>
                    <ee:transform doc:name="Transform Message" doc:id="96298f3c-1b5c-4093-bc38-ec352c69dd18" >
                        <ee:message >
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
                <when expression='#[error.errorType.asString=="SALESFORCE:NOT_FOUND"]'>
                    <ee:transform doc:name="Transform Message" doc:id="d8f13726-5e92-4d00-bed2-f7cb8bdd99a5" >
                        <ee:message >
                        </ee:message>
                        <ee:variables >
                            <ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
error.errorMessage.attributes.statusCode default 500]]></ee:set-variable>
                        </ee:variables>
                    </ee:transform>
                </when>
            </choice>
            <flow-ref doc:name="global-common-transform" doc:id="37d1578a-4f10-4960-bca9-2b1dc37a7201" name="global-common-transform"/>
			<flow-ref doc:name="global-common-error-exit" doc:id="91f42335-9ae5-492a-ae9e-605b6165f4bb" name="global-common-error-exit"/>
        </on-error-propagate>
	</error-handler>
	<sub-flow name="global-common-transform" doc:id="4d9adf0d-4cdd-4609-a57e-8d927ac4b9d9" >
		<ee:transform doc:name="error-reponse" doc:id="34d7a2b3-44ef-4f15-8ec9-339da8d7badc">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
	"errorCode": vars.errorCode,
  	"errorMessage": vars.errorDescription default error.detailedDescription,
  	"transactionId": payload.networkControl.transactionLocator default vars.correaltionID,
  	"timeStamp": now()
}]]></ee:set-payload>
				<ee:set-attributes><![CDATA[%dw 2.0
output application/java
---
httpStatus : vars.httpStatus default ""]]></ee:set-attributes>
			</ee:message>
			<ee:variables>
			</ee:variables>
		</ee:transform>
		<logger level="INFO" doc:name="Log Error Response" doc:id="842f8e71-bb77-4f90-814a-0cb61d6a84f9" message="LoggingErrorResponsePayload: #[payload]"/>
		<logger level="ERROR" doc:name="log-global-common-transform" doc:id="fbd6c57c-08bd-4211-abb8-8f27919c8933" message="httpStatus: #[vars.httpStatus]; response_error : #[payload]; errorMessage:#[error.errorMessage]; error: #[error] ; status: #[error.errorMessage.attributes.statusCode] ; attributes: #[error.errorMessage.attributes]"/>
	</sub-flow>
	<sub-flow name="global-common-start" doc:id="ee0ae377-7c3d-40cd-941f-025b36827bac" >
		<ee:transform doc:name="global start" doc:id="450a2366-51ff-4796-bacd-ccd755191148" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="globalStart" ><![CDATA[%dw 2.0
output application/json
var startTime = dw::util::Timer::currentMilliseconds()
---
{
	"requestPath": attributes.relativePath default "",
  	"transactionId": payload.networkControl.transactionLocator default "",
  	"businessTransactionGUID": payload.networkControl.businessTransactionGUID default "",
  	"timeStamp": now(),
  	"appName": app.name,
  	"startTime": startTime
}]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<logger level="INFO" doc:name="global-start" doc:id="24d5d187-7f53-40d1-92a9-399ae1e24924" message="request-start = #[vars.globalStart]"/>
	</sub-flow>
	<sub-flow name="global-common-error-exit" doc:id="39ecb6b2-d5e2-42e5-bf82-1fe4fae5641e" >
		<ee:transform doc:name="global error exit" doc:id="d9fd6469-11b7-4607-a47f-e4bbb5296bb7" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="globalErrorExit" ><![CDATA[%dw 2.0
output application/json
var exitTime = dw::util::Timer::currentMilliseconds()
---
{
	"requestPath": vars.globalStart.requestPath default "",
  	"transactionId": vars.globalStart.transactionId default "",
  	"correlationId": correlationId,
  	"timeStamp": now(),
  	"exitTime" : exitTime
}]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<!-- <logger level="ERROR" doc:name="global-error-exit" doc:id="9d5b8920-3ada-41db-9857-e9e596a674f0" message="request-exit = #[vars.globalErrorExit], #[app.name]_responseTime = #[vars.globalErrorExit.exitTime as Number - vars.globalStart.startTime as Number]"/> -->
	</sub-flow>
	<sub-flow name="global-common-exit" doc:id="797f8b21-ec95-48d4-a2ea-0d01a6091b3f" >
		<ee:transform doc:name="global success exit" doc:id="0f209b89-ceef-4d50-a982-5a4f18733153" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="globalSuccessExit" ><![CDATA[%dw 2.0
output application/json
var exitTime = dw::util::Timer::currentMilliseconds()
---
{
	"requestPath": vars.globalStart.requestPath default "",
  	"transactionId": vars.globalStart.transactionId default "",
  	"correlationId": correlationId,
  	"timeStamp": now(),
  	"exitTime": exitTime
}]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<!-- <logger level="INFO" doc:name="global-success-exit" doc:id="2a8a6cfd-3d3f-47ba-825a-b0c88c7613e4" message="request-exit = #[vars.globalSuccessExit], #[app.name]_responseTime = #[vars.globalSuccessExit.exitTime as Number - vars.globalStart.startTime as Number]"/> -->
	</sub-flow>
</mule>
